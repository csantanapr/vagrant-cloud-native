{
  "variables": {
    "box_base": "{{ env `BOX_BASE` }}",
    "box_base_version": "{{ env `BOX_BASE_VERSION` }}",
    "ansible_version": "{{ env `ANSIBLE_VERSION` }}",
    "minikube_version": "{{ env `MINIKUBE_VERSION` }}",
    "docker_version": "{{ env `DOCKER_VERSION` }}",
    "kubectl_version": "{{ env `KUBECTL_VERSION` }}",
    "helm_version": "{{ env `HELM_VERSION` }}",
    "vagrant_cloud_user": "{{ env `VAGRANT_CLOUD_USER` }}",
    "vagrant_cloud_box": "{{ env `VAGRANT_CLOUD_BOX` }}",
    "vagrant_cloud_token": "{{ env `VAGRANT_CLOUD_TOKEN` }}",
    "box_version": "{{ env `BOX_VERSION` }}",
    "box_version_description": "{{ env `BOX_VERSION_DESCRIPTION` }}"
  },
  "builders": [
    {
      "type": "vagrant",
      "communicator": "ssh",
      "source_path": "{{ user `box_base` }}",
      "box_version": "{{ user `box_base_version` }}",
      "provider": "virtualbox",
      "box_name": "{{ user `box_base` }}",
      "add_force": true,
      "template": "templates/Vagrantfile"
    }
  ],
  "provisioners": [
    {
      "type": "shell",
      "inline": [
        "sudo yum install -y epel-release",
        "sudo yum install -y python2-pip",
        "sudo pip2 install --upgrade pip",
        "sudo pip2 install ansible=={{ user `ansible_version` }}"
      ]
    },
    {
      "type": "ansible-local",
      "playbook_file": "ansible/install-minikube-centos-8.yml",
      "extra_arguments": [
        "--extra-vars \"minikube_version={{user `minikube_version`}} docker_version={{user `docker_version`}} kubectl_version={{user `kubectl_version`}}\""
      ]
    }
  ]
}